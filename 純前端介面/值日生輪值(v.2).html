<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公司同仁值日生輪值表系統</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #8dd3c7 0%, #7db3a8 100%);
            min-height: 100vh;
            color: #2d5a5a;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2d5a5a;
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #5a8080;
            font-size: 1.1rem;
        }
        
        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            gap: 10px;
        }
        
        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            color: #5a8080;
        }
        
        .nav-tab:hover {
            background: rgba(129, 216, 208, 0.15);
            color: #2d5a5a;
            transform: translateY(-2px);
        }
        
        .nav-tab.active {
            background: linear-gradient(135deg, #81d8d0 0%, #7db3a8 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(129, 216, 208, 0.3);
        }
        
        .tab-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            min-height: 600px;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #e6f7f5;
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2d5a5a;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #81d8d0 0%, #7db3a8 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(129, 216, 208, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #a8d8d0 0%, #81d8d0 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #b8d4d1 0%, #9bc7c2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: #e6f7f5;
            color: #2d5a5a;
        }
        
        .calendar-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #81d8d0 0%, #7db3a8 100%);
            color: white;
            border-radius: 10px;
        }
        
        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .calendar-nav button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .calendar-nav button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            background: #e6f7f5;
            border-radius: 10px;
            padding: 2px;
        }
        
        .calendar-day {
            background: white;
            padding: 15px 10px;
            min-height: 100px;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .calendar-day:hover {
            background: #f0fffe;
            transform: scale(1.02);
        }
        
        .day-number {
            font-weight: 600;
            color: #5a8080;
            margin-bottom: 5px;
        }
        
        .duty-person {
            background: linear-gradient(135deg, #81d8d0 0%, #7db3a8 100%);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            margin: 2px 0;
            display: block;
        }
        
        .weekend {
            background: #e6f7f5 !important;
        }
        
        .holiday {
            background: #d4f2ef !important;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d5a5a;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #e6f7f5;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #81d8d0;
            box-shadow: 0 0 0 3px rgba(129, 216, 208, 0.1);
        }
        
        .task-list {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e6f7f5;
            transition: all 0.3s ease;
        }
        
        .task-item:hover {
            background: #f0fffe;
        }
        
        .task-info h4 {
            color: #2d5a5a;
            margin-bottom: 5px;
        }
        
        .task-info p {
            color: #5a8080;
            font-size: 0.9rem;
        }
        
        .priority-high {
            border-left: 4px solid #b8d4d1;
        }
        
        .priority-medium {
            border-left: 4px solid #9bc7c2;
        }
        
        .priority-low {
            border-left: 4px solid #81d8d0;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .status-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        }
        
        .status-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #81d8d0;
            margin-bottom: 10px;
        }
        
        .status-label {
            color: #5a8080;
            font-size: 1.1rem;
        }
        
        .notification-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .notification-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            margin-bottom: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .notification-info {
            flex: 1;
        }
        
        .notification-time {
            color: #5a8080;
            font-size: 0.8rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from { opacity: 0; transform: scale(0.8) translateY(-50px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .modal-header h3 {
            color: #2d5a5a;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #5a8080;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .settings-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }
        
        .employee-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .employee-card {
            background: white;
            border: 2px solid #e6f7f5;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .employee-card:hover {
            border-color: #81d8d0;
            transform: translateY(-2px);
        }
        
        .employee-card.selected {
            border-color: #81d8d0;
            background: rgba(129, 216, 208, 0.1);
        }
        
        /* 調班狀態顏色 */
        .status-pending {
            background: #f0fffe;
            border: 1px solid #d4f2ef;
            color: #2d5a5a;
        }
        
        .status-approved {
            background: #e6f7f5;
            border: 1px solid #a8d8d0;
            color: #2d5a5a;
        }
        
        .status-rejected {
            background: #f5f5f5;
            border: 1px solid #d4d4d4;
            color: #666666;
        }
        
        /* 可代班狀態 */
        .available {
            color: #81d8d0;
        }
        
        .unavailable {
            color: #b8d4d1;
        }
        
        /* 工作日曆顏色 */
        .work-day {
            background: #e6f7f5;
        }
        
        .leave-day {
            background: #f0fffe;
        }
        
        .holiday-day {
            background: #d4f2ef;
        }
        
        .special-work {
            background: #f5fcfb;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
                font-size: 0.8rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📅 公司同仁值日生輪值表系統</h1>
            <p>智能化值日生管理系統，讓辦公環境維護更有效率</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('schedule')">📋 值日排班表</button>
            <button class="nav-tab" onclick="switchTab('tasks')">✅ 值日事項管理</button>
            <button class="nav-tab" onclick="switchTab('substitute')">🔄 緊急調班</button>
            <button class="nav-tab" onclick="switchTab('employees')">👥 員工參數設定</button>
            <button class="nav-tab" onclick="switchTab('holidays')">🎯 休假日設定</button>
        </div>
        
        <div class="tab-content">
            <!-- 值日排班表 -->
            <div class="tab-pane active" id="schedule">
                <div class="section-header">
                    <h2 class="section-title">值日排班表</h2>
                    <div>
                        <button class="btn btn-primary" onclick="generateSchedule()">🎲 產生下月排班</button>
                        <button class="btn btn-secondary" onclick="exportSchedule()">📤 匯出排班表</button>
                        <button class="btn btn-warning" onclick="clearSchedule()" style="margin-left: 10px;">🗑️ 清除排班</button>
                    </div>
                </div>
                
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-number">0</div>
                        <div class="status-label">今日值日生</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number">0</div>
                        <div class="status-label">本月工作日</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number">0</div>
                        <div class="status-label">待排班人次</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number">12</div>
                        <div class="status-label">參與員工數</div>
                    </div>
                </div>
                
                <div class="calendar-container">
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button onclick="previousMonth()">◀</button>
                            <h3 id="currentMonth">2024年 8月</h3>
                            <button onclick="nextMonth()">▶</button>
                            <button onclick="goToToday()" style="background: rgba(255, 255, 255, 0.3); margin-left: 10px;">📅 今天</button>
                        </div>
                        <div class="calendar-nav">
                            <div style="display: flex; gap: 15px; align-items: center;">
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <div style="width: 15px; height: 15px; background: #88e1d8; border-radius: 3px;"></div>
                                    工作日
                                </span>
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <div style="width: 15px; height: 15px; background: #e6f7f5; border-radius: 3px;"></div>
                                    週末
                                </span>
                                <span style="display: flex; align-items: center; gap: 5px;">
                                    <div style="width: 15px; height: 15px; background: #e3bae7; border-radius: 3px;"></div>
                                    國定假日
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- 日曆格子會由JavaScript生成 -->
                    </div>
                </div>
            </div>
            
            <!-- 值日事項管理 -->
            <div class="tab-pane" id="tasks">
                <div class="section-header">
                    <h2 class="section-title">值日事項管理</h2>
                    <button class="btn btn-primary" onclick="openModal('taskModal')">➕ 新增事項</button>
                
                </div>
                
                <div class="task-list" id="taskListContainer">
                    <!-- 任務列表會由JavaScript動態生成 -->
                </div>
            </div>
            
            <!-- 緊急調班 -->
            <div class="tab-pane" id="substitute">
                <div class="section-header">
                    <h2 class="section-title">緊急調班管理</h2>
                    <button class="btn btn-warning" onclick="openModal('substituteModal')">人員調換</button>
                </div>
                
                <div class="form-grid">
                    <div class="form-section">
                        <h3 style="margin-bottom: 20px; color: #2d5a5a;">📋 待處理申請</h3>
                        <div class="status-pending" style="border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <strong>王小明 - 8/25 調班申請</strong>
                                <span style="background: #d4f2ef; color: #2d5a5a; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem;">待審核</span>
                            </div>
                            <p style="color: #5a8080; margin-bottom: 10px;">原因：臨時家庭事務</p>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-success" style="padding: 8px 16px; font-size: 0.8rem;">✅ 同意</button>
                                <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.8rem;">❌ 拒絕</button>
                            </div>
                        </div>
                        
                        <div class="status-approved" style="border-radius: 8px; padding: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <strong>李小華 - 8/23 調班申請</strong>
                                <span style="background: #a8d8d0; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem;">已處理</span>
                            </div>
                            <p style="color: #5a8080;">已安排張大寶代班</p>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3 style="margin-bottom: 20px; color: #2d5a5a;">👥 可代班人員</h3>
                        <div class="employee-grid">
                            <div class="employee-card">
                                <div style="font-weight: bold;">張大寶</div>
                                <div class="available" style="font-size: 0.8rem;">可代班</div>
                            </div>
                            <div class="employee-card">
                                <div style="font-weight: bold;">陳小美</div>
                                <div class="available" style="font-size: 0.8rem;">可代班</div>
                            </div>
                            <div class="employee-card">
                                <div style="font-weight: bold;">劉大衛</div>
                                <div class="unavailable" style="font-size: 0.8rem;">請假中</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3 style="margin-bottom: 20px; color: #2d5a5a;">📊 調班記錄</h3>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f0fffe;">
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6f7f5;">日期</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6f7f5;">原值日生</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6f7f5;">代班人員</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6f7f5;">原因</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #e6f7f5;">狀態</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">2024-08-23</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">李小華</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">張大寶</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">臨時會議</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;"><span style="background: #a8d8d0; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem;">已完成</span></td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">2024-08-20</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">王小明</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">陳小美</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;">身體不適</td>
                                    <td style="padding: 12px; border-bottom: 1px solid #e6f7f5;"><span style="background: #a8d8d0; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem;">已完成</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- 員工參數設定 -->
            <div class="tab-pane" id="employees">
                <div class="section-header">
                    <h2 class="section-title">員工參數設定</h2>
                    <button class="btn btn-primary" onclick="openModal('employeeModal')">👤 新增員工</button>
                </div>
                
                <div class="settings-grid">
                    <div class="settings-card">
                        <h3 style="margin-bottom: 20px; color: #2d5a5a;">📅 月份設定</h3>
                        <div class="form-group">
                            <label class="form-label">選擇年月</label>
                            <input type="month" class="form-control" value="2024-08">
                        </div>
                        <button class="btn btn-primary" style="width: 100%;">載入月份資料</button>
                    </div>
                    
                    <div class="settings-card">
                        <h3 style="margin-bottom: 20px; color: #2d5a5a;">👥 員工選擇</h3>
                        <div class="form-group">
                            <label class="form-label">搜尋員工</label>
                            <input type="text" class="form-control" placeholder="輸入員工姓名或工號...">
                        </div>
                        <div class="employee-grid">
                            <div class="employee-card selected">
                                <div style="font-weight: bold;">王小明</div>
                                <div style="color: #5a8080; font-size: 0.8rem;">A001</div>
                            </div>
                            <div class="employee-card">
                                <div style="font-weight: bold;">李小華</div>
                                <div style="color: #5a8080; font-size: 0.8rem;">A002</div>
                            </div>
                            <div class="employee-card">
                                <div style="font-weight: bold;">張大寶</div>
                                <div style="color: #5a8080; font-size: 0.8rem;">A003</div>
                            </div>
                            <div class="employee-card">
                                <div style="font-weight: bold;">陳小美</div>
                                <div style="color: #5a8080; font-size: 0.8rem;">A004</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="settings-card" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2d5a5a;">📋 工作日曆設定 - 王小明 (2024年8月)</h3>
                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-bottom: 20px;">
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">日</div>
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">一</div>
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">二</div>
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">三</div>
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">四</div>
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">五</div>
                        <div style="text-align: center; font-weight: bold; padding: 10px; color: #2d5a5a;">六</div>
                        
                        <!-- 日曆格子 -->
                        <div style="padding: 8px; text-align: center; background: #dfbde3; border-radius: 5px; cursor: pointer; color: #2d5a5a;">1</div>
                        <div style="padding: 8px; text-align: center; background: #e4bc76; border-radius: 5px; cursor: pointer; color: #2d5a5a;">2</div>
                        <div style="padding: 8px; text-align: center; background: #d0f9f4; border-radius: 5px; cursor: pointer; color: #2d5a5a;">3</div>
                        <div style="padding: 8px; text-align: center; background: #d0f9f4; border-radius: 5px; cursor: pointer; color: #2d5a5a;">4</div>
                        <div style="padding: 8px; text-align: center; background: #d0f9f4; border-radius: 5px; cursor: pointer; color: #2d5a5a;">5</div>
                        <div style="padding: 8px; text-align: center; background: #d0f9f4; border-radius: 5px; cursor: pointer; color: #2d5a5a;">6</div>
                        <div style="padding: 8px; text-align: center; background: #d0f9f4; border-radius: 5px; cursor: pointer; color: #2d5a5a;">7</div>
                    </div>
                    
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #d0f9f4; border-radius: 4px;"></div>
                            <span>正常上班</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #e4bc76; border-radius: 4px;"></div>
                            <span>請假</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #dfbde3; border-radius: 4px;"></div>
                            <span>休假</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <div style="width: 20px; height: 20px; background: #e3f2b3; border-radius: 4px;"></div>
                            <span>特殊上班</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-success">💾 儲存設定</button>
                        <button class="btn btn-secondary">🔄 重設</button>
                        <button class="btn btn-primary">📤 批量設定</button>
                    </div>
                </div>
            </div>
            
            <!-- 休假日設定 -->
            <div class="tab-pane" id="holidays">
                <div class="section-header">
                    <h2 class="section-title">休假日參數設定</h2>
                    <div>
                        <button class="btn btn-primary" onclick="openModal('holidayModal')">🎯 新增假日</button>
                        <button class="btn btn-secondary" onclick="importTemplate()">📥 匯入範本</button>
                    </div>
                </div>
                
                <div class="settings-grid">
                    <div class="settings-card">
                        <h3 style="margin-bottom: 20px; color: #2d5a5a;">📅 年度選擇</h3>
                        <div class="form-group">
                            <label class="form-label">選擇年度</label>
                            <select class="form-control">
                                <option value="2024" selected>2024年</option>
                                <option value="2025">2025年</option>
                                <option value="2026">2026年</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;">載入年度資料</button>
                    </div>
                    
                    <div class="settings-card">
                        <h3 style="margin-bottom: 20px; color: #2d5a5a;">📊 假日統計</h3>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>國定假日：</span>
                            <span style="font-weight: bold; color: #81d8d0;">15 天</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>彈性放假：</span>
                            <span style="font-weight: bold; color: #9bc7c2;">8 天</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>補班日：</span>
                            <span style="font-weight: bold; color: #b8d4d1;">6 天</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>公司假日：</span>
                            <span style="font-weight: bold; color: #a8d8d0;">3 天</span>
                        </div>
                    </div>
                </div>
                
                <div class="settings-card" style="margin-top: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2d5a5a;">🗓️ 2024年假日設定</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div style="background: #f0fffe; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #2d5a5a; margin-bottom: 15px;">🎊 第一季假日</h4>
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>元旦</span>
                                    <span style="color: #5a8080;">1/1</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>春節假期</span>
                                    <span style="color: #5a8080;">2/8-2/14</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>和平紀念日</span>
                                    <span style="color: #5a8080;">2/28</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #f0fffe; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #2d5a5a; margin-bottom: 15px;">🌸 第二季假日</h4>
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>兒童節</span>
                                    <span style="color: #5a8080;">4/4</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>清明節</span>
                                    <span style="color: #5a8080;">4/5</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>勞動節</span>
                                    <span style="color: #5a8080;">5/1</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #f0fffe; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #2d5a5a; margin-bottom: 15px;">☀️ 第三季假日</h4>
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>端午節</span>
                                    <span style="color: #5a8080;">6/10</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>公司週年慶</span>
                                    <span style="color: #5a8080;">8/15</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #f0fffe; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #2d5a5a; margin-bottom: 15px;">🍂 第四季假日</h4>
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>中秋節</span>
                                    <span style="color: #5a8080;">9/17</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>國慶日</span>
                                    <span style="color: #5a8080;">10/10</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e6f7f5;">
                                    <span>聖誕節</span>
                                    <span style="color: #5a8080;">12/25</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; display: flex; gap: 10px;">
                        <button class="btn btn-success">💾 儲存設定</button>
                        <button class="btn btn-secondary">🔄 重設</button>
                        <button class="btn btn-primary">👁️ 預覽檢查</button>
                        <button class="btn btn-warning">📤 匯出設定</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab panes
            const tabPanes = document.querySelectorAll('.tab-pane');
            tabPanes.forEach(pane => pane.classList.remove('active'));
            
            // Remove active class from all nav tabs
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab pane
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked nav tab
            event.target.classList.add('active');
        }

        // Calendar functionality
        let currentDate = new Date();
        
        function generateCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Update month display
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', 
                              '7月', '8月', '9月', '10月', '11月', '12月'];
            document.getElementById('currentMonth').textContent = `${year}年 ${monthNames[month]}`;
            
            // Clear calendar
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['日', '一', '二', '三', '四', '五', '六'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.style.cssText = 'background: #81d8d0; color: white; padding: 10px; text-align: center; font-weight: bold;';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                emptyDay.style.background = '#f8f9fa';
                calendarGrid.appendChild(emptyDay);
            }
            
            // Add days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                const dayOfWeek = (firstDay + day - 1) % 7;
                
                // Apply weekend styling
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayElement.classList.add('weekend');
                }
                
                // Add day number
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);
                
                // Add duty person (sample data)
                if (day % 3 === 1 && dayOfWeek !== 0 && dayOfWeek !== 6) {
                    const dutyPerson = document.createElement('div');
                    dutyPerson.className = 'duty-person';
                    const employees = ['王小明', '李小華', '張大寶', '陳小美'];
                    dutyPerson.textContent = employees[Math.floor(Math.random() * employees.length)];
                    dayElement.appendChild(dutyPerson);
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }
        
        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }
        
        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }
        
        function goToToday() {
            currentDate = new Date();
            generateCalendar();
        }
        
        // Modal functionality
        function openModal(modalId) {
            // Create and show modal (simplified for demo)
            alert('功能開發中...');
        }
        
        // Other functions
        function generateSchedule() {
            alert('產生下月排班功能開發中...');
        }
        
        function exportSchedule() {
            alert('匯出排班表功能開發中...');
        }
        
        function clearSchedule() {
            if (confirm('確定要清除所有排班資料嗎？')) {
                alert('排班已清除');
                generateCalendar();
            }
        }
        
        function importTemplate() {
            alert('匯入範本功能開發中...');
        }
        
        // Initialize calendar on page load
        document.addEventListener('DOMContentLoaded', function() {
            generateCalendar();
        });
    </script>
</body>

    
    <!-- 新增事項 Modal -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('taskModal')">×</button>
            <div class="modal-header">
                <h3>➕ 新增值日事項</h3>
                <p style="color: #718096;">建立新的值日工作事項</p>
            </div>
            
            <div class="form-group">
                <label class="form-label">事項名稱</label>
                <input type="text" id="taskName" class="form-control" placeholder="例：清潔辦公區域地面">
            </div>
            
            <div class="form-group">
                <label class="form-label">詳細說明</label>
                <textarea id="taskDescription" class="form-control" rows="3" placeholder="詳細描述工作內容和執行方式..."></textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">優先順序</label>
                <select id="taskPriority" class="form-control">
                    <option value="high">必要</option>
                    <option value="medium">建議</option>
                    <option value="low">選擇性</option>
                </select>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="btn btn-primary" style="flex: 1;" onclick="addNewTask()">✅ 建立事項</button>
                <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('taskModal')">❌ 取消</button>
            </div>
        </div>
    </div>
    
    <!-- 調班申請 Modal -->
    <div class="modal" id="substituteModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('substituteModal')">×</button>
            <div class="modal-header">
                <h3>🔄 人員調換</h3>
                <p style="color: #718096;">管理員調換值日人員</p>
            </div>
            
            <div class="form-group">
                <label class="form-label">調換日期</label>
                <input type="date" id="substituteDate" class="form-control">
            </div>
            
            <div class="form-group">
                <label class="form-label">建議代班人員</label>
                <select id="substituteEmployee" class="form-control">
                    <option value="">請選擇代班人員</option>
                    <!-- 選項會由JavaScript動態生成 -->
                </select>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="btn btn-warning" style="flex: 1;" onclick="confirmSubstitute()">✅ 確認</button>
                <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('substituteModal')">❌ 取消</button>
            </div>
        </div>
    </div>
    
    <!-- 新增員工 Modal -->
    <div class="modal" id="employeeModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('employeeModal')">×</button>
            <div class="modal-header">
                <h3>👤 新增員工</h3>
                <p style="color: #718096;">新增參與值日的員工資料</p>
            </div>
            
            <div class="form-group">
                <label class="form-label">員工姓名</label>
                <input type="text" class="form-control" placeholder="請輸入員工姓名">
            </div>
            
    
            
            <div class="form-group">
                <label class="form-label">部門</label>
                <select class="form-control">
                    <option value="">請選擇部門</option>
                    <option value="hr">人力資源部</option>
                    <option value="it">資訊技術部</option>
                    <option value="finance">財務部</option>
                    <option value="sales">業務部</option>
                    <option value="admin">行政部</option>
                </select>
            </div>
            
            
            
            <div class="form-group">
                <label class="form-label">電子郵件</label>
                <input type="email" class="form-control" placeholder="請輸入電子郵件">
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="btn btn-primary" style="flex: 1;">✅ 新增員工</button>
                <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('employeeModal')">❌ 取消</button>
            </div>
        </div>
    </div>
    
    <!-- 新增假日 Modal -->
    <div class="modal" id="holidayModal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal('holidayModal')">×</button>
            <div class="modal-header">
                <h3>🎯 新增假日</h3>
                <p style="color: #718096;">新增國定假日或公司特殊假日</p>
            </div>
            
            <div class="form-group">
                <label class="form-label">假日名稱</label>
                <input type="text" class="form-control" placeholder="例：公司成立紀念日">
            </div>
            
            <div class="form-group">
                <label class="form-label">假日類型</label>
                <select class="form-control">
                    <option value="national">國定假日</option>
                    <option value="flexible">彈性放假</option>
                    <option value="company">公司假日</option>
                    <option value="makeup">補班日</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label">開始日期</label>
                <input type="date" class="form-control">
            </div>
            
            <div class="form-group">
                <label class="form-label">結束日期</label>
                <input type="date" class="form-control">
            </div>
            
    
            
            <div style="display: flex; gap: 10px; margin-top: 30px;">
                <button class="btn btn-primary" style="flex: 1;">✅ 新增假日</button>
                <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('holidayModal')">❌ 取消</button>
            </div>
        </div>
    </div>

    <script>
        // 標籤切換功能
        function switchTab(tabName) {
            // 移除所有活動狀態
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            
            // 添加新的活動狀態
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Modal 控制功能
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // 點擊 modal 外部關閉
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }

        // 全域變數儲存當前日期和排班資料
        let currentYear = 2024;
        let currentMonthIndex = 7; // 0=1月, 7=8月
        let scheduleData = {}; // 儲存所有月份的排班資料，格式: { "2024-8": { 1: ["王小明", "李小華"], 2: ["張大寶", "陳小美"] } }
        let employees = ['王小明', '李小華', '張大寶', '陳小美', '劉大衛', '趙小花', '吳小強', '林小美', '黃大明', '鄭小華', '蔡小英', '許大寶'];
        
        // 值日事項管理
        let taskList = [
            {
                id: 1,
                name: '清潔辦公區域地面',
                description: '使用掃把和拖把清潔所有辦公區域地面',
                priority: 'high',
                completed: false
            },
            {
                id: 2,
                name: '清空垃圾桶並更換垃圾袋',
                description: '清空所有辦公室垃圾桶，更換新的垃圾袋',
                priority: 'high',
                completed: true
            },
          
            {
                id: 3,
                name: '澆灌辦公室植物',
                description: '為辦公室綠色植物澆水',
                priority: 'low',
                completed: true
            }
        ];
        let nextTaskId = 5;
        
        // 調班記錄
        let substituteRecords = [
            {
                id: 1,
                date: '2024-08-23',
                originalEmployee: '李小華',
                substituteEmployee: '張大寶'
            },
            {
                id: 2,
                date: '2024-08-20',
                originalEmployee: '王小明',
                substituteEmployee: '陳小美'
            }
        ];
        let nextSubstituteId = 3;

        // 日曆生成功能
        function generateCalendar() {
            const grid = document.getElementById('calendarGrid');
            const currentMonth = new Date(currentYear, currentMonthIndex, 1);
            const daysInMonth = new Date(currentYear, currentMonthIndex + 1, 0).getDate();
            const firstDay = currentMonth.getDay();
            
            // 更新月份標題
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
            document.getElementById('currentMonth').textContent = `${currentYear}年 ${monthNames[currentMonthIndex]}`;
            
            // 清空現有內容
            grid.innerHTML = '';
            
            // 添加星期標題
            const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
            weekdays.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.textContent = day;
                dayHeader.style.cssText = `
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 15px;
                    text-align: center;
                    font-weight: bold;
                `;
                grid.appendChild(dayHeader);
            });

            // 添加空白天數
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                grid.appendChild(emptyDay);
            }

            // 取得當前月份的排班資料
            const monthKey = `${currentYear}-${currentMonthIndex}`;
            const monthSchedule = scheduleData[monthKey] || {};

            // 添加本月天數
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayElement.appendChild(dayNumber);

                // 判斷是否為週末
                const dayOfWeek = (firstDay + day - 1) % 7;
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayElement.classList.add('weekend');
                }

                // 添加假日標記
                const holidays = getHolidaysForMonth(currentYear, currentMonthIndex);
                if (holidays.includes(day)) {
                    dayElement.classList.add('holiday');
                }

                // 只在工作日顯示值日生，且有排班資料時才顯示
                if (!dayElement.classList.contains('weekend') && !dayElement.classList.contains('holiday')) {
                    if (monthSchedule[day]) {
                        // 有排班資料時顯示
                        monthSchedule[day].forEach(person => {
                            const dutyPerson = document.createElement('span');
                            dutyPerson.className = 'duty-person';
                            dutyPerson.textContent = person;
                            dayElement.appendChild(dutyPerson);
                        });
                    } else {
                        // 沒有排班資料時顯示提示
                        const noSchedule = document.createElement('div');
                        noSchedule.style.cssText = `
                            color: #a0aec0;
                            font-size: 0.8rem;
                            text-align: center;
                            margin-top: 10px;
                            font-style: italic;
                        `;
                        noSchedule.textContent = '未排班';
                        dayElement.appendChild(noSchedule);
                    }
                }

                grid.appendChild(dayElement);
            }
        }

        // 產生排班功能
        function generateSchedule() {
            // 計算下個月
            let nextYear = currentYear;
            let nextMonth = currentMonthIndex + 1;
            
            if (nextMonth > 11) {
                nextMonth = 0;
                nextYear++;
            }
            
            const monthKey = `${nextYear}-${nextMonth}`;
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
            
            // 確認是否要重新產生排班
            if (scheduleData[monthKey]) {
                const confirm = window.confirm(`${nextYear}年${monthNames[nextMonth]}已有排班資料，是否要重新產生？`);
                if (!confirm) return;
            }
            
            // 獲取下個月的工作日
            const workDays = getWorkDays(nextYear, nextMonth);
            
            if (workDays.length === 0) {
                alert('下個月沒有工作日需要排班！');
                return;
            }
            
            // 顯示產生中的提示
            showNotification('🎲 產生排班中', `正在為${nextYear}年${monthNames[nextMonth]}產生排班...`);
            
            // 模擬處理時間
            setTimeout(() => {
                // 隨機分配值日生
                const monthSchedule = {};
                const employeeWorkCount = {}; // 記錄每個員工的值日次數
                
                // 初始化員工工作次數
                employees.forEach(emp => {
                    employeeWorkCount[emp] = 0;
                });
                
                workDays.forEach(day => {
                    // 選擇兩位值日生，優先選擇值日次數較少的員工
                    const selectedEmployees = [];
                    const availableEmployees = [...employees];
                    
                    // 按值日次數排序（少的在前）
                    availableEmployees.sort((a, b) => employeeWorkCount[a] - employeeWorkCount[b]);
                    
                    // 選擇前兩位（添加一些隨機性）
                    for (let i = 0; i < 2; i++) {
                        let selectedIndex;
                        if (Math.random() < 0.7) {
                            // 70%機率選擇值日次數最少的前3位
                            selectedIndex = Math.floor(Math.random() * Math.min(3, availableEmployees.length));
                        } else {
                            // 30%機率隨機選擇
                            selectedIndex = Math.floor(Math.random() * availableEmployees.length);
                        }
                        
                        const selectedEmployee = availableEmployees.splice(selectedIndex, 1)[0];
                        selectedEmployees.push(selectedEmployee);
                        employeeWorkCount[selectedEmployee]++;
                    }
                    
                    monthSchedule[day] = selectedEmployees;
                });
                
                // 儲存排班資料
                scheduleData[monthKey] = monthSchedule;
                
                // 跳轉到下個月顯示結果
                currentYear = nextYear;
                currentMonthIndex = nextMonth;
                generateCalendar();
                updateCalendarData();
                
                // 顯示成功訊息
                showNotification('✅ 排班完成', `${nextYear}年${monthNames[nextMonth]}排班已產生完成！共${workDays.length}個工作日，${workDays.length * 2}人次`);
                
                // 更新統計資料
                updateStatistics();
                
            }, 1000); // 1秒後完成
        }
        
        // 獲取指定月份的工作日
        function renderTaskList() {
            const container = document.getElementById('taskListContainer');
            container.innerHTML = '';
            
            if (taskList.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #a0aec0;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">📝</div>
                        <p>尚未建立任何值日事項</p>
                        <p style="font-size: 0.9rem;">點擊上方「➕ 新增事項」按鈕開始建立</p>
                    </div>
                `;
                return;
            }
            
            taskList.forEach(task => {
                const taskItem = document.createElement('div');
                taskItem.className = `task-item priority-${task.priority}`;
                
                const priorityLabels = {
                    high: { text: '必要', color: '#fed7d7', textColor: '#c53030' },
                    medium: { text: '建議', color: '#feebc8', textColor: '#c05621' },
                    low: { text: '選擇性', color: '#c6f6d5', textColor: '#2f855a' }
                };
                
                const priority = priorityLabels[task.priority];
                const icon = getTaskIcon(task.name);
                
                taskItem.innerHTML = `
                    <div class="task-info">
                        <h4>${icon} ${task.name}</h4>
                        <p>${task.description}</p>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span style="background: ${priority.color}; color: ${priority.textColor}; padding: 4px 12px; border-radius: 6px; font-size: 0.8rem;">${priority.text}</span>
                        <input type="checkbox" ${task.completed ? 'checked' : ''} 
                               onchange="toggleTaskCompletion(${task.id})" 
                               style="transform: scale(1.3);">
                        <button onclick="deleteTask(${task.id})" 
                                style="background: #fed7d7; color: #c53030; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer;">🗑️</button>
                    </div>
                `;
                
                if (task.completed) {
                    taskItem.style.opacity = '0.7';
                    taskItem.style.textDecoration = 'line-through';
                }
                
                container.appendChild(taskItem);
            });
        }
        
        function getTaskIcon(taskName) {
            const name = taskName.toLowerCase();
            if (name.includes('清潔') || name.includes('掃')) return '🧹';
            if (name.includes('垃圾')) return '🗑️';
            if (name.includes('照明') || name.includes('燈')) return '💡';
            if (name.includes('植物') || name.includes('澆')) return '🌱';
            if (name.includes('檢查')) return '🔍';
            if (name.includes('整理')) return '📚';
            if (name.includes('消毒')) return '🧼';
            return '✅';
        }
        
        function updateTaskStatistics() {
            // 移除統計更新功能，因為統計區塊已刪除
        }
        
        function addNewTask() {
            const name = document.getElementById('taskName').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const priority = document.getElementById('taskPriority').value;
            
            if (!name) {
                alert('請輸入事項名稱');
                return;
            }
            
            if (!description) {
                alert('請輸入詳細說明');
                return;
            }
            
            const newTask = {
                id: nextTaskId++,
                name: name,
                description: description,
                priority: priority,
                completed: false
            };
            
            taskList.push(newTask);
            
            // 清空表單
            document.getElementById('taskName').value = '';
            document.getElementById('taskDescription').value = '';
            document.getElementById('taskPriority').value = 'high';
            
            // 更新顯示
            renderTaskList();
            
            // 關閉modal並顯示成功訊息
            closeModal('taskModal');
            showNotification('✅ 新增成功', `事項「${name}」已成功新增！`);
        }
        
        function toggleTaskCompletion(taskId) {
            const task = taskList.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                renderTaskList();
            }
        }
        
        function deleteTask(taskId) {
            const task = taskList.find(t => t.id === taskId);
            if (task && confirm(`確定要刪除事項「${task.name}」嗎？`)) {
                taskList = taskList.filter(t => t.id !== taskId);
                renderTaskList();
                showNotification('🗑️ 刪除完成', `事項「${task.name}」已刪除`);
            }
        }
        function getWorkDays(year, month) {
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const holidays = getHolidaysForMonth(year, month);
            const workDays = [];
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dayOfWeek = new Date(year, month, day).getDay();
                const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
                const isHoliday = holidays.includes(day);
                
                if (!isWeekend && !isHoliday) {
                    workDays.push(day);
                }
            }
            
            return workDays;
        }

        function exportSchedule() {
            const monthKey = `${currentYear}-${currentMonthIndex}`;
            const monthSchedule = scheduleData[monthKey];
            
            if (!monthSchedule || Object.keys(monthSchedule).length === 0) {
                alert('📤 目前沒有排班資料可以匯出\n\n請先產生排班表');
                return;
            }
            
            alert('📤 匯出排班表功能\n\n將會產生 Excel 檔案供下載');
        }
        
        // 清除排班功能
        function clearSchedule() {
            const monthKey = `${currentYear}-${currentMonthIndex}`;
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
            
            if (!scheduleData[monthKey]) {
                alert('🗑️ 目前沒有排班資料可以清除');
                return;
            }
            
            const confirmClear = window.confirm(`確定要清除 ${currentYear}年${monthNames[currentMonthIndex]} 的所有排班資料嗎？\n\n此操作無法復原！`);
            
            if (confirmClear) {
                delete scheduleData[monthKey];
                generateCalendar();
                updateStatistics();
                showNotification('🗑️ 清除完成', `${currentYear}年${monthNames[currentMonthIndex]}的排班資料已清除`);
            }
        }

        // 取得特定月份的假日
        function getHolidaysForMonth(year, month) {
            const holidaysByMonth = {
                0: [1], // 1月：元旦
                1: [8, 9, 10, 11, 12, 13, 14, 28], // 2月：春節、和平紀念日
                2: [], // 3月
                3: [4, 5], // 4月：兒童節、清明節
                4: [1], // 5月：勞動節
                5: [10], // 6月：端午節
                6: [], // 7月
                7: [15], // 8月：公司週年慶
                8: [17], // 9月：中秋節
                9: [10], // 10月：國慶日
                10: [], // 11月
                11: [25] // 12月：聖誕節
            };
            return holidaysByMonth[month] || [];
        }

        // 月份切換功能
        function previousMonth() {
            currentMonthIndex--;
            if (currentMonthIndex < 0) {
                currentMonthIndex = 11;
                currentYear--;
            }
            generateCalendar();
            updateCalendarData();
        }

        function nextMonth() {
            currentMonthIndex++;
            if (currentMonthIndex > 11) {
                currentMonthIndex = 0;
                currentYear++;
            }
            generateCalendar();
            updateCalendarData();
        }

        // 更新日曆數據統計
        function updateCalendarData() {
            const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
            console.log(`切換到 ${currentYear}年 ${monthNames[currentMonthIndex]}`);
            
            // 重新計算統計數據
            const daysInMonth = new Date(currentYear, currentMonthIndex + 1, 0).getDate();
            const holidays = getHolidaysForMonth(currentYear, currentMonthIndex);
            
            let workDays = 0;
            for (let day = 1; day <= daysInMonth; day++) {
                const dayOfWeek = new Date(currentYear, currentMonthIndex, day).getDay();
                const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
                const isHoliday = holidays.includes(day);
                
                if (!isWeekend && !isHoliday) {
                    workDays++;
                }
            }
            
            // 更新統計顯示
            const statusNumbers = document.querySelectorAll('.status-number');
            if (statusNumbers.length >= 4) {
                statusNumbers[1].textContent = workDays; // 工作日數
                statusNumbers[2].textContent = workDays * 2; // 值日人次（每天2人）
            }
        }

        function importTemplate() {
            alert('📥 匯入政府行事曆範本\n\n將會載入官方假日資料');
        }

        // 員工卡片選擇功能
        document.addEventListener('DOMContentLoaded', function() {
            const employeeCards = document.querySelectorAll('.employee-card');
            employeeCards.forEach(card => {
                card.addEventListener('click', function() {
                    // 移除其他選中狀態
                    employeeCards.forEach(c => c.classList.remove('selected'));
                    // 添加選中狀態
                    this.classList.add('selected');
                });
            });

            // 生成日曆
            generateCalendar();
            
            // 初始化統計數據
            updateStatistics();
            
            // 初始化值日事項管理
            renderTaskList();
            
            // 初始化人員調換管理
            renderAvailableEmployees();
            renderSubstituteRecords();
            updateSubstituteEmployeeOptions();
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const taskItem = this.closest('.task-item');
                    if (this.checked) {
                        taskItem.style.opacity = '0.7';
                        taskItem.style.textDecoration = 'line-through';
                    } else {
                        taskItem.style.opacity = '1';
                        taskItem.style.textDecoration = 'none';
                    }
                });
            });

            // 表單提交處理
            document.querySelectorAll('.btn-primary').forEach(btn => {
                if (btn.textContent.includes('提交') || btn.textContent.includes('新增員工') || btn.textContent.includes('新增假日')) {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        const modal = this.closest('.modal');
                        if (modal && modal.id !== 'taskModal') { // 排除taskModal，因為它有自己的處理函數
                            setTimeout(() => {
                                alert('✅ 操作成功完成！');
                                modal.classList.remove('active');
                            }, 100);
                        }
                    });
                }
            });

            // 自動通知系統模擬
            setInterval(function() {
                const now = new Date();
                const hour = now.getHours();
                const minute = now.getMinutes();
                
                // 模擬每月21號9點的自動排班
                if (hour === 9 && minute === 0) {
                    showNotification('🎲 系統自動排班', '下個月的值日排班表已自動產生');
                }
                
                // 模擬每月21號12點的排班通知
                if (hour === 12 && minute === 0) {
                    showNotification('📋 排班表通知', '本月值日排班表已發送給全體同仁');
                }
                
                // 模擬值日當天12點的個人提醒
                if (hour === 12 && minute === 0) {
                    showNotification('⏰ 值日提醒', '您今天是值日生，請記得執行值日工作');
                }
            }, 60000); // 每分鐘檢查一次

            // 任務完成狀態切換
        });

        function showNotification(title, message) {
            // 創建通知元素
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: white;
                border-left: 4px solid #667eea;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                z-index: 9999;
                min-width: 300px;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="font-weight: bold; color: #4a5568; margin-bottom: 5px;">${title}</div>
                <div style="color: #718096; font-size: 0.9rem;">${message}</div>
                <button onclick="this.parentElement.remove()" style="position: absolute; top: 5px; right: 10px; background: none; border: none; font-size: 1.2rem; cursor: pointer; color: #718096;">×</button>
            `;
            
            document.body.appendChild(notification);
            
            // 3秒後自動移除
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 3000);
        }

        // 數據統計更新
        function updateStatistics() {
            // 模擬統計數據更新
            const stats = {
                todayDuty: Math.floor(Math.random() * 3) + 1,
                workDays: calculateWorkDays(), // 使用計算出的工作日
                monthlyDuty: calculateWorkDays() * 2, // 每天2人
                employees: 12 + Math.floor(Math.random() * 8)
            };
            
            // 更新顯示的統計數字
            const statusNumbers = document.querySelectorAll('.status-number');
            if (statusNumbers.length >= 4) {
                statusNumbers[0].textContent = stats.todayDuty;
                statusNumbers[1].textContent = stats.workDays;
                statusNumbers[2].textContent = stats.monthlyDuty;
                statusNumbers[3].textContent = stats.employees;
            }
        }

        // 計算當前月份的工作日數
        function calculateWorkDays() {
            const daysInMonth = new Date(currentYear, currentMonthIndex + 1, 0).getDate();
            const holidays = getHolidaysForMonth(currentYear, currentMonthIndex);
            
            let workDays = 0;
            for (let day = 1; day <= daysInMonth; day++) {
                const dayOfWeek = new Date(currentYear, currentMonthIndex, day).getDay();
                const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
                const isHoliday = holidays.includes(day);
                
                if (!isWeekend && !isHoliday) {
                    workDays++;
                }
            }
            return workDays;
        }
        
        // 檢查當前月份是否已有排班
        function hasSchedule() {
            const monthKey = `${currentYear}-${currentMonthIndex}`;
            return scheduleData[monthKey] && Object.keys(scheduleData[monthKey]).length > 0;
        }
        
        // 更新統計數據（根據實際排班情況）
        function updateStatistics() {
            const monthKey = `${currentYear}-${currentMonthIndex}`;
            const monthSchedule = scheduleData[monthKey];
            
            let scheduledDays = 0;
            let scheduledPeople = 0;
            
            if (monthSchedule) {
                scheduledDays = Object.keys(monthSchedule).length;
                scheduledPeople = Object.values(monthSchedule).reduce((total, daySchedule) => total + daySchedule.length, 0);
            }
            
            const totalWorkDays = calculateWorkDays();
            
            const stats = {
                todayDuty: hasSchedule() ? 2 : 0, // 如果有排班則顯示2，否則顯示0
                workDays: totalWorkDays,
                monthlyDuty: scheduledPeople, // 實際已排班人次
                employees: employees.length
            };
            
            // 更新顯示的統計數字
            const statusNumbers = document.querySelectorAll('.status-number');
            const statusLabels = document.querySelectorAll('.status-label');
            
            if (statusNumbers.length >= 4) {
                statusNumbers[0].textContent = stats.todayDuty;
                statusNumbers[1].textContent = stats.workDays;
                statusNumbers[2].textContent = stats.monthlyDuty;
                statusNumbers[3].textContent = stats.employees;
                
                // 更新標籤顯示排班狀態
                if (statusLabels.length >= 3) {
                    statusLabels[2].textContent = hasSchedule() ? '已排班人次' : '待排班人次';
                }
            }
        }

        // 鍵盤快捷鍵支持
        document.addEventListener('keydown', function(e) {
            // ESC 關閉 modal
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal.active').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
            
            // Ctrl + 數字切換標籤
            if (e.ctrlKey && e.key >= '1' && e.key <= '5') {
                e.preventDefault();
                const tabs = ['schedule', 'tasks', 'substitute', 'employees', 'holidays'];
                const tabIndex = parseInt(e.key) - 1;
                if (tabs[tabIndex]) {
                    document.querySelectorAll('.nav-tab')[tabIndex].click();
                }
            }
        });

        // 添加 CSS 動畫
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            .task-item {
                transition: all 0.3s ease;
            }
            
            .employee-card {
                transition: all 0.3s ease;
            }
            
            .calendar-day:hover .duty-person {
                transform: scale(1.05);
            }
            
            .btn {
                position: relative;
                overflow: hidden;
            }
            
            .btn::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
                transition: left 0.5s;
            }
            
            .btn:hover::before {
                left: 100%;
            }
            
            .status-card {
                position: relative;
                overflow: hidden;
            }
            
            .status-card::before {
                content: '';
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: linear-gradient(45deg, transparent, rgba(102, 126, 234, 0.1), transparent);
                transform: rotate(45deg);
                transition: all 0.5s;
                opacity: 0;
            }
            
            .status-card:hover::before {
                animation: shimmer 1s ease-in-out;
            }
            
            @keyframes shimmer {
                0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); opacity: 0; }
                50% { opacity: 1; }
                100% { transform: translateX(100%) translateY(100%) rotate(45deg); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // 工具提示功能
        function addTooltips() {
            const tooltipElements = [
                { selector: '.btn-primary', text: '點擊執行主要操作' },
                { selector: '.employee-card', text: '點擊選擇員工' },
                { selector: '.calendar-day', text: '查看當日值日安排' },
                { selector: '.task-item input[type="checkbox"]', text: '標記任務完成狀態' }
            ];

            tooltipElements.forEach(item => {
                document.querySelectorAll(item.selector).forEach(element => {
                    element.title = item.text;
                });
            });
        }

        // 頁面載入完成後初始化工具提示
        window.addEventListener('load', addTooltips);

        // 響應式處理
        function handleResize() {
            const container = document.querySelector('.container');
            const width = window.innerWidth;
            
            if (width < 768) {
                container.style.padding = '10px';
            } else if (width < 1024) {
                container.style.padding = '15px';
            } else {
                container.style.padding = '20px';
            }
        }

        window.addEventListener('resize', handleResize);
        
        // 頁面可見性處理
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                console.log('用戶切換到其他頁面');
            } else {
                console.log('用戶回到值日系統');
                updateStatistics(); // 回到頁面時更新統計數據
            }
        });

        // 新增快速跳轉功能
        function jumpToMonth(year, month) {
            currentYear = year;
            currentMonthIndex = month;
            generateCalendar();
            updateCalendarData();
        }

        // 新增今天按鈕功能
        function goToToday() {
            const today = new Date();
            currentYear = today.getFullYear();
            currentMonthIndex = today.getMonth();
            generateCalendar();
            updateCalendarData();
        }
    </script>
</body>
</html>2024-08-23</td>
                                                      